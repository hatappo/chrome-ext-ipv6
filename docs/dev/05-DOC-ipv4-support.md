# IPv4サポート追加 - 設計ドキュメント

## 概要
既存のIPv6変換機能にIPv4サポートを追加します。UIは現在のものを流用し、IPv4アドレスの場合は4行のうち最初の1行のみに32ビットを表示します。

## 設計方針

### 1. 最小限のUI変更
- 新しいUIコンポーネントは追加せず、既存のUIを拡張
- IPv4の場合は128ビット表示の最初の32ビットのみを使用
- 残りの96ビットは空白または非表示

### 2. 自動判定機能
- 入力されたアドレスを自動的にIPv4/IPv6として判定
- 明示的な切り替えUIは不要

### 3. 共通インターフェース
- IPv4とIPv6で共通の関数インターフェースを提供
- 内部実装は分離しつつ、呼び出し側は統一的に扱える

## 実装詳細

### IPv4アドレスの検証
```typescript
// IPv4の正規表現パターン
const IPV4_PATTERN = /^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;

// 検証関数
function isValidIPv4(address: string): boolean {
  return IPV4_PATTERN.test(address);
}
```

### IPv4からビット表記への変換
```typescript
function ipv4ToBits(ipv4: string): string {
  const octets = ipv4.split('.');
  const bits = octets.map(octet => {
    const num = parseInt(octet, 10);
    return num.toString(2).padStart(8, '0');
  });
  
  // IPv6形式に合わせて":"区切りで返す（32ビットのみ）
  return bits.join('');
}
```

### ビット表示の調整
- IPv4の場合：32ビットを表示し、残りは空
- IPv6の場合：従来通り128ビットを2行で表示

### エラーハンドリング
- IPv4でもIPv6でもない場合は「有効なIPアドレスを入力してください」と表示
- アドレスタイプを明示的に示す必要はない

## 考慮事項

### パフォーマンス
- 正規表現による判定は高速
- ビット変換も単純な計算のみ

### 互換性
- 既存のIPv6機能に影響なし
- 後方互換性を維持

### 拡張性
- 将来的に他のアドレス形式にも対応可能な設計