# 01-DOC-extension-base

## 概要

IPv6アドレスを検出してビット表記に変換するChrome拡張機能を実装しました。

## 技術スタック

- **フレームワーク**: Plasmo v0.90.5
- **言語**: TypeScript 5.8.3
- **UI**: React 19.1.0
- **テスト**: Vitest 3.2.4
- **リンター/フォーマッター**: Biome 2.1.1
- **パッケージマネージャ**: npm 11.4.2 (Volta管理)
- **Node.js**: 24.3.0 (Volta管理)

## 実装された機能

### 1. IPv6アドレス検出・変換機能

#### コンテンツスクリプト (`src/contents/plasmo.ts`)
- ページ上のIPv6アドレスを自動検出
- 16進数表記をビット表記に変換して表示
- 動的に追加されるコンテンツも監視（MutationObserver）

#### 変換ユーティリティ (`src/utils/ipv6-converter.ts`)
- `normalizeIPv6()`: IPv6アドレスの正規化（::の展開、4桁パディング）
- `ipv6ToBits()`: 16進数表記からビット表記への変換
- `isValidIPv6()`: IPv6アドレスの妥当性検証

### 2. ポップアップUI (`src/popup.tsx`)
- IPv6アドレスの手動入力・変換機能
- エラーハンドリング
- レスポンシブデザイン

### 3. テスト (`src/utils/ipv6-converter.test.ts`)
- 全主要関数のユニットテスト
- 様々なIPv6形式のテストケース

## 設計方針

### アーキテクチャ
- **モジュール分離**: 変換ロジックをユーティリティとして分離
- **再利用性**: コンテンツスクリプトとポップアップで共通のユーティリティを使用
- **型安全性**: TypeScriptによる型チェック

### コード品質
- **ESLint/Prettier代替**: Biomeによる統一されたコード品質管理
- **テストカバレッジ**: 主要な変換機能に対する包括的テスト
- **アクセシビリティ**: ラベル要素の適切な関連付け

## 対応するIPv6形式

- 完全形式: `2001:db8:85a3:0:0:8a2e:370:7334`
- 短縮形式: `2001:db8::1`
- ループバック: `::1`  
- 全ゼロ: `::`
- 先頭/末尾の短縮: `2001:db8::`、`::1`

## ファイル構造

```
src/
├── contents/
│   └── plasmo.ts          # コンテンツスクリプト
├── utils/
│   ├── ipv6-converter.ts  # 変換ユーティリティ
│   └── ipv6-converter.test.ts  # テスト
├── test/
│   └── setup.ts           # テストセットアップ
└── popup.tsx              # ポップアップUI
```

## 開発・ビルド

```bash
# 開発モード
npm run dev

# プロダクションビルド
npm run build

# テスト実行
npm test

# リンター
npm run lint
npm run lint:fix

# フォーマッター
npm run format
```

## 今後の改善案

1. **設定機能**: 変換の有効/無効切り替え
2. **表示形式**: ビット表記の区切り文字カスタマイズ
3. **パフォーマンス**: 大量のIPv6アドレスがある場合の最適化
4. **国際化**: 多言語対応
5. **統計機能**: 変換回数の記録

## 注意事項

- Chrome拡張機能の権限は最小限に設定
- セキュリティ上の理由で、HTTPSサイトでのみ動作
- 複雑な正規表現による検出のため、パフォーマンスに注意が必要